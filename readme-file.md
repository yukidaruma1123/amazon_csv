# Amazon出荷通知処理システム

Amazon注文レポートから出荷通知用TXTファイルを自動生成するWebアプリケーションです。

## システムについて
Amazonセラーセントラルからダウンロードした注文レポートCSVを処理し、出荷通知用のタブ区切りTXTファイルを自動生成します。生成されたファイルは、Amazonセラーセントラルの「注文関連ファイルをアップロード」で直接使用できます。

## 必要なファイル

### 出荷通知テンプレート（自動読み込み）
- **ファイル名**: Flat.File.ShippingConfirmation.jp.xls
- **配置場所**: index.htmlと同じフォルダ
- **内容**: Amazon標準の出荷通知テンプレート

### Amazon注文レポート（必須）
- **形式**: CSVファイル(.csv)
- **取得元**: Amazonセラーセントラル > レポート > フルフィルメント > 注文レポート
- **内容**: 注文番号、出荷日、配送業者、追跡番号を含む

## セットアップ

### ファイル構成
```
project-folder/
├── index.html                              # メインアプリケーション
├── Flat.File.ShippingConfirmation.jp.xls   # テンプレートファイル
├── README.md                               # このファイル
└── manual.md                              # 操作マニュアル
```

### 起動方法
1. 上記ファイルを同一フォルダに配置
2. ブラウザで `index.html` を開く
3. インターネット接続必須（外部ライブラリ使用）

## 技術仕様

### 対応ブラウザ
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

### 使用ライブラリ
- **XLSX.js**: エクセルファイル読み込み
- **PapaParse**: CSV解析
- **Tailwind CSS**: スタイリング

### 出力ファイル仕様
- **ファイル名**: shipping_notification_YYYY-MM-DD.txt
- **形式**: タブ区切りテキスト（UTF-8）
- **仕様**: Amazon OrderFulfillment Template Version 2011.1102準拠

### 対応配送業者
| 配送業者名 | 配送業者コード |
|------------|----------------|
| ヤマト運輸 | YAMATO        |
| 佐川急便   | SAGAWA        |
| 日本郵便   | Japan Post    |
| フェデックス | FEDEX       |

## データ抽出ルール

### 自動抽出項目
- **注文番号**: ###-#######-#######形式を自動検出
- **出荷日**: 日付形式を自動検出・YYYY-MM-DD形式に変換
- **配送業者**: キーワードマッチングで自動判定
- **追跡番号**: 10-15桁の連続数字を自動抽出

## トラブルシューティング

| エラー | 対処法 |
|--------|--------|
| テンプレートファイルが読み込めない | Flat.File.ShippingConfirmation.jp.xlsがindex.htmlと同じフォルダにあるか確認 |
| CSVファイルが読み込めない | Amazon標準の注文レポート形式か確認 |
| データ処理ボタンが押せない | CSVファイルが正しく選択されているか確認 |
| ダウンロードできない | ブラウザのポップアップブロック設定を確認 |

## 注意事項
- **セキュリティ**: すべての処理はブラウザ内で完結
- **バックアップ**: 元データのバックアップを必ず取る
- **対応環境**: JavaScript有効・インターネット接続必須
- **サポート対象外**: Internet Explorer・オフライン環境

## 更新履歴

### v1.0.0 (2025-07-03)
- 初回リリース
- Amazon注文レポート対応
- 主要配送業者対応
- 自動データ抽出機能

---

**詳細な操作方法**: [manual.md](manual.md)をご参照ください。